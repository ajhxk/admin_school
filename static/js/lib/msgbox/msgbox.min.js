(function () {
    $.MsgBox = {
        Alert: function (title, msg, callback) {
            var ts = title.split("::");
            var iew = "info";
            if (ts.length > 1) {
                if (ts[1] == "tip") {
                    iew = "tip";
                } else if (ts[1] == "warning") {
                    iew = "warning";
                } else if(ts[1]=='none'){
                    iew = "none";
                }
            }
            GenerateHtml("alert", iew, ts[0], msg);
            btnOk(callback);
            btnNo();
        },
        Confirm: function (title, msg, callback, btnText) {
            if(!btnText){btnText = '确认::取消'}
            var ts = title.split("::");
            var iew = "info";
            var btnokText = btnText.split('::')[0],
                btnnoText = btnText.split('::')[1];
            if (ts.length > 1) {
                if (ts[1] == 'tip') {
                    iew = "tip";
                } else if (ts[1] == "warning") {
                    iew = "warning";
                } else if(ts[1] == 'none'){
                    iew = "none";
                }
            }

            GenerateHtml("confirm", iew, ts[0], msg, btnokText, btnnoText);
            btnOk(callback);
            btnNo();
        },
        Show: function (title, html, callback, btnText) {
            if(!btnText){btnText = '确认::取消'}

            var btnokText = btnText.split('::')[0],
                btnnoText = btnText.split('::')[1];

            var iew = "no";
            GenerateHtml("confirm", iew, title, html,btnokText, btnnoText);
            btnShowOk(callback);
            btnNo();
        },
        Box:function(){
            return $("#mb_msg");
        },
        Cancel:function(){
            $("#mb_box,#mb_con").remove();
        },
        Modal:function (title, html, callback){
            var ts = title.split("::");
            var iew = "info";
            if (ts.length > 1) {
                if (ts[1] == "tip") {
                    iew = "tip";
                } else if (ts[1] == "warning") {
                    iew = "warning";
                }
            }
            GenerateHtml("modal", iew, ts[0], html);
            btnNo();
        }
    }
    window['Alert'] = $.MsgBox['Alert'];
    window['Confirm'] = $.MsgBox['Confirm'];
    window['Show'] = $.MsgBox['Show'];
    window['Box'] = $.MsgBox['Box'];
    window['Modal'] = $.MsgBox['Modal'];
    window['Cancel'] = $.MsgBox['Cancel'];
    //生成Html
    var GenerateHtml = function (type, iew, title, msg,btnokText, btnnoText) {
        var img = "";
        if (iew != "no") {
            if (type == "confirm") {
                //img += '<img src="';
                if (iew == "tip") {
                    img += '<img src="../static/images/msgbox/tip.png">';
                } else if (iew == "warning") {
                    img += '<img src="../static/images/msgbox/warning.png">';
                } else if(iew == 'none'){
                    img += '';
                }else {
                    img += '<img src="../static/images/msgbox/info.png">';
                }
            }
            if (type == "alert") {
                //img += '<img src="';
                if (iew == "tip") {
                    img += '<img src="../static/images/msgbox/tip.png">';
                } else if (iew == "warning") {
                    img += '<img src="../static/images/msgbox/warning.png">';
                } else if(iew == 'none'){
                    img += '';
                }else {
                    img += '<img src="../static/images/msgbox/info.png">';
                }
            }
        }


        var _html = "";
        _html += '<div id="mb_box"></div><div id="mb_con"><span id="mb_tit" class="mb_tit">' + title + '</span>';
        _html += '<a id="mb_ico"><img src="../static/images/msgbox/close.png" /></a>' +
            '<div id="mb_msg" class="mb_msg">';
        if (img != "") {
            _html += '<span id="img">' + img + '</span>';
        }
        _html += '<p id="mgs_box">' + msg + '</div></p><div id="mb_btnbox">';
        if (type == "alert") {
            _html += '<input id="mb_btn_ok" type="button" value="确定" />';
        }
        if (type == "modal"){

        }
        if (type == "confirm") {
            _html += '<input id="mb_btn_ok" type="button" value="' +btnokText  +'" />';

            _html += '<input id="mb_btn_no" type="button" value="' + btnnoText  +'" />';

        }
        _html += '</div></div>';
        //必须先将_html添加到body，再设置Css样式
        $("body").append(_html);
        GenerateCss();
    }
    //生成Css
    var GenerateCss = function () {
        $("#mb_box").css({
            width: '100%', height: '100%', zIndex: '99999', position: 'fixed',
            filter: 'Alpha(opacity=40)', backgroundColor: '#333', top: '0', left: '0', opacity: '0.4'
        });
        $("#mb_con").css({
            zIndex: '999999', width: '580px',height:'210px', position: 'fixed',
            backgroundColor: 'White', borderRadius: '0px', "box-shadow":'0px 0px 10px #333',
            "-moz-box-shadow":"0px 0px 10px #333","-webkit-box-shadow":"0px 0px 10px #333"
        });
        $("#mb_tit").css({
            "display": 'inline-block', "font-size": '14px', color: '#333', padding: '7px 15px 7px 20px',
            "background-color": '#FFF', "border-radius": '2px 2px 0 0', "font-weight": 'bold',
            "box-sizing":'border-box',width:'100%',height:'40px',"line-height":'26px'
        });
        $("#mb_msg").css({
            padding: '20px',
            lineHeight: '20px',
            fontSize: '12px',
            "color":'#333',
            margin: "0 auto",
            width: '100%',
            height:'90px',
            textAlign: 'left',
            "box-sizing":"border-box",
            position:'relative'
        });
        $("#mb_ico").css({

            display: 'block', position: 'absolute', right: '10px', top: '0px', fontSize: '20px',

            width: '18px', height: '18px', textAlign: 'center', cursor: 'pointer', fontFamily: '微软雅黑', color: '#999'
        });
        $("#mgs_box").css({
            display: "inline-block",
            wordBreak: 'break-all',
            textAlign: 'left',
            marginTop: '0',
            marginBottom: '0'
        });
        $("#img").css({marginTop: '0', display: 'inline-block', width: '32px', height: '30'});
        $("#img").find('img').css({float: 'left', marginTop: '9px'});
        $("#mb_btnbox").css({margin: '21px 20px', textAlign: 'right'});
        $("#mb_btn_ok,#mb_btn_no").css({width: '75px', height: '25px', color: 'white', border: 'none'});
        $("#mb_btn_ok").css({
            backgroundColor: '#00c18b',
            width: '130px',
            height: '36px',
            borderRadius: '0',
            cursor: 'pointer',
            fontFamily: '微软雅黑',
            fontSize: '14px'
        });
        $("#mb_btn_no").css({
            backgroundColor: '#333',
            marginLeft: '10px',
            border: '1px solid #e6e6e6',
            color: '#fff',
            width: '98px',
            height: '35px',
            borderRadius: '0px',
            cursor: 'pointer',
            fontSize: '14px',
            fontFamily: '微软雅黑'
        });
        //右上角关闭按钮hover样式
        $("#mb_ico").find("img").hover(function () {
            $(this).attr({src: '../static/images/msgbox/close_hover.png'});
        }, function () {
            $(this).attr({src: '../static/images/msgbox/close.png'});
        });


        //取消按钮滑入效果
        $("#mb_btn_no").hover(function () {
            $(this).css({backgroundColor: '#404040'});
        }, function () {
            $(this).css({backgroundColor: '#333'})
        });
        //确定按钮滑入效果
        $("#mb_btn_ok").hover(function () {
            $(this).css({backgroundColor: '#00b380'});
        }, function () {
            $(this).css({backgroundColor: '#00c18b'})
        });
        var _widht = document.documentElement.clientWidth; //屏幕宽
        var _height = document.documentElement.clientHeight; //屏幕高
        var boxWidth = $("#mb_con").width();
        var boxHeight = $("#mb_con").height();
        //让提示框居中
        //$("#mb_con").css({top: (_height - boxHeight) / 2 + "px", left: (_widht - boxWidth) / 2 + "px"});
        //$("#mb_con").css({ top: "30%", left: "30%" });
        $("#mb_con").css({top: "200px", left: (_widht - boxWidth) / 2 + "px"});
    }
    //确定按钮事件
    var btnOk = function (callback) {
        $("#mb_btn_ok").click(function () {
            if (typeof (callback) == 'function') {
                callback();
            }
            $("#mb_box,#mb_con").remove();
        });
    }

    var btnShowOk = function (callback) {
        $("#mb_btn_ok").click(function () {
            if (typeof (callback) == 'function') {
                if(!callback()){
                    return false;
                }
            }
            $("#mb_box,#mb_con").remove();
        });
    }

    // 取消按钮事件
    var btnNo = function (noCallback) {
        $("#mb_btn_no,#mb_ico").click(function () {
            $("#mb_box,#mb_con").remove();
        });
    }

})();
