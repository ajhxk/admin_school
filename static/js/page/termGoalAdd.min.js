$(function(){

navActiveSet('course_set');

//字段规则检查
function checkParams() {

    var termname = $('#termName').val();
    if(!verification.empty(termname)){
        $('.errorSign').text('');
        $('#errorSign_termName').text('请输入学期名称');
        return false;
    }
    if(!verification.max(termname, 20)){
        $('.errorSign').text('');
        $('#errorSign_termName').text('请输入20字以内的学期名称');
        return false;
    }

    var termstarttime = $('#termStartTime').val();
    if(!verification.empty(termstarttime)){
        $('.errorSign').text('');
        $('#errorSign_termTime').text('请输入正确的学期开始和结束时间');
        return false;
    }

    var termendtime = $('#termEndTime').val();
    if(!verification.empty(termendtime)){
        $('.errorSign').text('');
        $('#errorSign_termTime').text('请输入正确的学期开始和结束时间');
        return false;
    }

    if(!verification.compare(termstarttime, termendtime)){
        $('.errorSign').text('');
        $('#errorSign_termTime').text('请输入正确的学期开始和结束时间');
        return false;
    }

    var termtargetboy = $('#termTargetBoy').val();
    if(!verification.empty(termtargetboy)){
        $('.errorSign').text('');
        $('#errorSign_termTargetBoy').text('请输入目标公里数');
        return false;
    }

    var daytargetboy = $('#dayTargetBoy').val();
    if(!verification.empty(daytargetboy)){
        $('.errorSign').text('');
        $('#errorSign_dayTargetBoy').text('请输入每日目标');
        return false
    }

    var termtargetgirl = $('#termTargetGirl').val();
    if(!verification.empty(termtargetgirl)){
        $('.errorSign').text('');
        $('#errorSign_termTargetGirl').text('请输入目标公里数');
        return false;
    }

    var daytargetgirl = $('#dayTargetGirl').val();
    if(!verification.empty(daytargetgirl)){
        $('.errorSign').text('');
        $('#errorSign_dayTargetGirl').text('请输入每日目标');
        return false;
    }


    var unids = $('#unids').val();
    if(!verification.empty(unids)){
        $('.errorSign').text('');
        $('#errorSign_campusSelect').text('请选择应用校区');
        return false;
    }

    return true;
}



$('#termGoalSave').click(function(){


    var campusSelected = $(".campusSelect:checked"),

        campus_len = campusSelected.length,

        unids = '';

    for(var i=0; i<campus_len; i++){
        if(i==0){
            unids += campusSelected.eq(0).val();
        }else{
            unids += ','+campusSelected.eq(i).val();
        }
    }
    $('#unids').attr('value',unids);


    if (!checkParams()) {return false;}

    if(!lock.lock()){return false;}

    //字段错误提示清除
    $('.errorSign').text('');

    $('#termGoalSave_form').ajaxSubmit({

        url:'',
        cache:false,
        dataType:'json',
        success:function(data){
            if(data.type == 200){
                window.location.href = '';
            }else {

                lock.reset();
                alert(data.msg)
            }
        },
        error:function(){
            lock.reset();
        }
    });

});


$('#termGoalCancel').click(function(){
    window.history.go(-1);
});


});